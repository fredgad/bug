onload=(()=>{var e,t=document.getElementById("cont"),o=document.getElementById("start"),n=document.getElementById("loose"),s=document.getElementById("handle"),r=document.getElementById("ladybug"),a=(document.getElementsByClassName("controls"),document.querySelector("#hiddenId")?parseInt(document.querySelector("#hiddenId").innerHTML):void 0),d=!1,i=!1,l=!1,c=!0,f=t.offsetWidth/2,p=t.offsetHeight/2,m=3,u=3,h=3,y=0,g=0,M=40,H=-1,L=r.offsetHeight,T=r.offsetWidth,b=Date.now(),v=['<p class="pm" date="-15">🌑</p>','<p class="pm" date="-5">🌘</p>','<p class="pm" date="1">🌗</p>','<p class="pm" date="3">🌖</p>','<p class="pm" date="5">🌕</p>','<p class="pm" date="3">🌔</p>','<p class="pm" date="1">🌓</p>','<p class="pm" date="-5">🌒</p>'];function I(){var e=Math.floor(255*Math.random()),s=Math.floor(255*Math.random()),r=Math.floor(255*Math.random());t.style.background="rgb("+e+","+s+","+r+")",o.style.background="rgb("+e+","+s+","+r+")",n.style.background="rgb("+e+","+s+","+r+")"}function k(e){"left"==e?(d=!0,i=!1,l=!1,c=!1):"right"==e?(d=!1,i=!0,l=!1,c=!1):"top"==e?(d=!1,i=!1,l=!0,c=!1):"bottom"==e?(d=!1,i=!1,l=!1,c=!0):"menu_button"==e&&I()}o.addEventListener("click",function(e){e.preventDefault();var t="val="+parseInt(10*u)+"&id="+a,o=new XMLHttpRequest;o.open("POST","includes/ajax.php",!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onload=function(){},o.send(t),function(){var e=new XMLHttpRequest;e.open("POST","includes/ajax.php",!0),e.onload=function(){if(200==this.status){var e=JSON.parse(this.responseText),t=[];for(g in e)t.push(e[g].score+"."+e[g].login);let o=0,n=0;for(let e=0;e<t.length;e++)o<parseInt(t[e])&&(o=parseInt(t[e]),n=e);document.querySelector("#rec").innerHTML=parseInt(t[n]),document.querySelector("#recName").innerHTML=t[n].split(".")[1],document.querySelector("#yRec")&&(document.querySelector("#yRec").innerHTML=e[a-1].score)}},e.send()}()}),document.body.addEventListener("selectstart",e=>{e.preventDefault()}),s.addEventListener("click",e=>{k(e.target.className)}),document.body.addEventListener("keydown",e=>{let t;37!=e.keyCode&&65!=e.keyCode||(t="left"),38!=e.keyCode&&87!=e.keyCode||(t="top"),39!=e.keyCode&&68!=e.keyCode||(t="right"),40!=e.keyCode&&83!=e.keyCode||(t="bottom"),k(t)}),o.addEventListener("click",()=>{o.style.top=-o.offsetHeight-9+"px",o.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)",m=3,u=3,H=-1,f=t.offsetWidth/2,p=t.offsetHeight/2,d=!1,i=!1,l=!1,c=!0,record.innerHTML=0,screen_speed.innerHTML="Speed: 30 t.k.p.s.",score_speed.innerHTML="Max speed: 30";var n=setInterval(()=>{!function(o,n){this.x=o,this.y=n,this.start=Date.now(),t.innerHTML+='<div class="moon'+y+'">0 <p class="pm">🌑</p></div>';let s=document.querySelector(".moon"+y);y++,s.style.top=this.x+"px",s.style.left=this.y+"px",function t(){let o=Date.now()-b;if(o>M){e=document.querySelectorAll("#cont div");for(let t=0;t<e.length;t++){let n=parseInt(e[t].innerHTML)+1;M=o+140,n>=v.length&&(n=0),e[t].innerHTML=n+" "+v[n]}}requestAnimationFrame(()=>{t()})}()}(Math.floor(Math.random()*t.offsetHeight),Math.floor(Math.random()*t.offsetWidth)),m<3&&(clearInterval(n),t.innerHTML="")},1847)}),n.addEventListener("click",()=>{n.style.top=t.offsetHeight+9+"px",n.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)",o.innerHTML="🌚AGAIN!🌝",setTimeout(()=>{o.style.top=t.offsetHeight/80*25+"px",n.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)"},300)}),function o(){switch(!0){case d:f-=m,r.style.transform="rotate(-90deg)";break;case i:f+=m,r.style.transform="rotate(90deg)";break;case l:p-=m,r.style.transform="rotate(0deg)";break;case c:p+=m,r.style.transform="rotate(180deg)"}r.style.top=p+"px",r.style.left=f+"px",requestAnimationFrame(()=>{!function(){e=document.querySelectorAll("#cont div"),left&&f+r.offsetWidth<0?f=t.offsetWidth:right&&f-r.offsetWidth>t.offsetWidth&&(f=-r.offsetWidth),top&&p+r.offsetHeight<0?p=t.offsetHeight:bottom&&p-r.offsetHeight>t.offsetHeight&&(p=-r.offsetHeight);for(let t=0;t<e.length;t++)if(r.offsetTop+L>e[t].offsetTop&&r.offsetTop<e[t].offsetTop+e[t].offsetHeight&&r.offsetLeft+T>e[t].offsetLeft&&r.offsetLeft<e[t].offsetLeft+e[t].offsetWidth)return m+=e[t].children[0].getAttribute("date")/3,u=Math.max(u,m),h=Math.max(h,m),H++,record.innerHTML=H,screen_speed.innerHTML="Speed: "+parseInt(10*m)+" t.k.p.s.",score_speed.innerHTML="Max speed: "+parseInt(10*u),best_speed.innerHTML="Best speed today: "+parseInt(10*h),score_moon.innerHTML="Moons: "+(H+1),document.getElementById("gest_record")&&(document.getElementById("gest_record").innerHTML="Лучший результат сегодння: "+parseInt(10*h)),m<3&&(m=0,n.style.top="0px",n.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)"),e[t].style.display="none",record.innerHTML++,I(),h}(),o()})}()});