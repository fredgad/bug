onload=(()=>{var e,t,n=document.getElementById("cont"),o=document.getElementById("start"),s=document.getElementById("loose"),r=document.getElementById("rules"),d=document.getElementById("resume"),l=document.getElementById("handle"),a=document.getElementById("ladybug"),i=document.getElementById("game_rules"),c=document.getElementById("menu_table"),f=document.getElementById("menu_button"),p=document.getElementById("static_color"),y=(document.getElementsByClassName("controls"),document.querySelector("#hiddenId")?parseInt(document.querySelector("#hiddenId").innerHTML):void 0),m=!1,u=!1,h=!1,g=!0,M=!1,H=!1,L=n.offsetWidth/2,I=n.offsetHeight/2,b=3,v=3,T=3,k=0,E=0,x=40,B=-1,q=a.offsetHeight,S=a.offsetWidth,_=Date.now(),W=['<p class="pm" date="-15">🌑</p>','<p class="pm" date="-5">🌘</p>','<p class="pm" date="1">🌗</p>','<p class="pm" date="3">🌖</p>','<p class="pm" date="5">🌕</p>','<p class="pm" date="3">🌔</p>','<p class="pm" date="1">🌓</p>','<p class="pm" date="-5">🌒</p>'];function w(e){e.preventDefault();var t="val="+parseInt(10*v)+"&id="+y,n=new XMLHttpRequest;n.open("POST","includes/ajax.php",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onload=function(){},n.send(t),function(){var e=new XMLHttpRequest;e.open("POST","includes/ajax.php",!0),e.onload=function(){if(200==this.status){var e=JSON.parse(this.responseText),t=[];for(E in e)t.push(e[E].score+"."+e[E].login);let n=0,o=0;for(let e=0;e<t.length;e++)n<parseInt(t[e])&&(n=parseInt(t[e]),o=e);document.querySelector("#rec").innerHTML=parseInt(t[o]),document.querySelector("#recName").innerHTML=t[o].split(".")[1],document.querySelector("#yRec")&&(document.querySelector("#yRec").innerHTML=e[y-1].score)}},e.send()}()}function C(){var e=Math.floor(255*Math.random()),t=Math.floor(255*Math.random()),r=Math.floor(255*Math.random());n.style.background="rgb("+e+","+t+","+r+")",o.style.background="rgb("+e+","+t+","+r+")",s.style.background="rgb("+e+","+t+","+r+")"}function A(){if(M=!M,"grid"==c.style.display?c.style.display="none":c.style.display="grid",M)t=b,b=.001;else{b=t;let e=setInterval(()=>{N(Math.floor(Math.random()*n.offsetHeight-30),Math.floor(Math.random()*n.offsetWidth-30)),b<=0&&(clearInterval(e),n.innerHTML=""),M&&clearInterval(e)},1847)}}function D(e){"left"==e?(m=!0,u=!1,h=!1,g=!1):"right"==e?(m=!1,u=!0,h=!1,g=!1):"top"==e?(m=!1,u=!1,h=!0,g=!1):"bottom"==e&&(m=!1,u=!1,h=!1,g=!0)}function N(t,o){this.x=t,this.y=o,this.start=Date.now(),n.innerHTML+='<div class="moon'+k+'">0 <p class="pm">🌑</p></div>';let s=document.querySelector(".moon"+k);k++,s.style.top=this.x+"px",s.style.left=this.y+"px",function t(){let n=Date.now()-_;if(n>x){e=document.querySelectorAll("#cont div");for(let t=0;t<e.length;t++){let o=parseInt(e[t].innerHTML)+1;x=n+140,o>=W.length&&(o=0),e[t].innerHTML=o+" "+W[o]}}requestAnimationFrame(()=>{t()})}()}o.addEventListener("click",w),s.addEventListener("click",w),document.body.addEventListener("selectstart",e=>{e.preventDefault()}),f.addEventListener("click",()=>{f.style.display="none",setTimeout(()=>{f.style.display="flex"},1848),A(),r.style.display="none"}),document.getElementById("color_button").addEventListener("click",()=>{C()}),i.addEventListener("click",()=>{"none"==r.style.display?(r.style.display="flex",i.style.color="rgb(190, 6, 6)"):(r.style.display="none",i.style.color="rgb(250, 221, 59)")}),p.addEventListener("click",()=>{H=!H,p.style.color=H?"rgb(190, 6, 6)":"rgb(250, 221, 59)"}),d.addEventListener("click",()=>{A(),r.style.display="none"}),l.addEventListener("click",e=>{D(e.target.className)}),document.body.addEventListener("keydown",e=>{let t;37!=e.keyCode&&65!=e.keyCode||(t="left"),38!=e.keyCode&&87!=e.keyCode||(t="top"),39!=e.keyCode&&68!=e.keyCode||(t="right"),40!=e.keyCode&&83!=e.keyCode||(t="bottom"),D(t)}),o.addEventListener("click",()=>{o.style.top=-o.offsetHeight-9+"px",o.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)",b=3,v=3,B=-1,L=n.offsetWidth/2,I=n.offsetHeight/2,m=!1,u=!1,h=!1,g=!0,record.innerHTML=0,screen_speed.innerHTML="Speed: 30 t.k.p.s.",score_speed.innerHTML="Max speed: 30";let e=setInterval(()=>{N(Math.floor(Math.random()*n.offsetHeight-30),Math.floor(Math.random()*n.offsetWidth-30)),b<=0&&(clearInterval(e),n.innerHTML=""),M&&clearInterval(e)},1847)}),s.addEventListener("click",()=>{s.style.top=n.offsetHeight+9+"px",s.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)",o.innerHTML="🌚AGAIN!🌝",setTimeout(()=>{o.style.top=n.offsetHeight/80*25+"px",s.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)"},300)}),function t(){switch(!0){case m:L-=b,a.style.transform="rotate(-90deg)";break;case u:L+=b,a.style.transform="rotate(90deg)";break;case h:I-=b,a.style.transform="rotate(0deg)";break;case g:I+=b,a.style.transform="rotate(180deg)"}a.style.top=I+"px",a.style.left=L+"px",requestAnimationFrame(()=>{!function(){e=document.querySelectorAll("#cont div"),L<0&&I<0&&(L=n.offsetWidth,I=n.offsetHeight),left&&L+a.offsetWidth<0?L=n.offsetWidth:right&&L-a.offsetWidth>n.offsetWidth&&(L=-a.offsetWidth),top&&I+a.offsetHeight<0?I=n.offsetHeight:bottom&&I-a.offsetHeight>n.offsetHeight&&(I=-a.offsetHeight);for(let t=0;t<e.length;t++)if(a.offsetTop+q>e[t].offsetTop&&a.offsetTop<e[t].offsetTop+e[t].offsetHeight&&a.offsetLeft+S>e[t].offsetLeft&&a.offsetLeft<e[t].offsetLeft+e[t].offsetWidth)return b+=e[t].children[0].getAttribute("date")/3,v=Math.max(v,b),T=Math.max(T,b),B++,record.innerHTML=B,screen_speed.innerHTML="Speed: "+parseInt(10*b)+" t.k.p.s.",score_speed.innerHTML="Max speed: "+parseInt(10*v),best_speed.innerHTML="Best speed today: "+parseInt(10*T),score_moon.innerHTML="Moons: "+(B+1),document.getElementById("gest_record")&&(document.getElementById("gest_record").innerHTML="Лучший результат сегодння: "+parseInt(10*T)),b<=2&&(b=0,s.style.top="0px",s.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)"),e[t].style.display="none",record.innerHTML++,H||C(),T}(),t()})}()});