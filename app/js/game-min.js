onload=(()=>{var e,t=document.getElementById("cont"),o=document.getElementById("start"),n=document.getElementById("loose"),s=document.getElementById("handle"),r=document.getElementById("ladybug"),a=(document.getElementsByClassName("controls"),!1),d=!1,i=!1,l=!0,f=t.offsetWidth/2,c=t.offsetHeight/2,p=3,m=3,u=3,h=0,y=0,g=40,H=-1,M=r.offsetHeight,L=r.offsetWidth,b=Date.now(),T=['<p class="pm" date="-5">🌑</p>','<p class="pm" date="-3">🌘</p>','<p class="pm" date="1">🌗</p>','<p class="pm" date="3">🌖</p>','<p class="pm" date="5">🌕</p>','<p class="pm" date="3">🌔</p>','<p class="pm" date="-1">🌓</p>','<p class="pm" date="-3">🌒</p>'];function k(){var e=Math.floor(255*Math.random()),s=Math.floor(255*Math.random()),r=Math.floor(255*Math.random());t.style.background="rgb("+e+","+s+","+r+")",o.style.background="rgb("+e+","+s+","+r+")",n.style.background="rgb("+e+","+s+","+r+")"}function v(e){"left"==e?(a=!0,d=!1,i=!1,l=!1):"right"==e?(a=!1,d=!0,i=!1,l=!1):"top"==e?(a=!1,d=!1,i=!0,l=!1):"bottom"==e?(a=!1,d=!1,i=!1,l=!0):"menu_button"==e&&k()}o.addEventListener("click",function(e){e.preventDefault();let t=parseInt(1*u),o=document.querySelector("#hiddenId").innerHTML;alert(o+" : "+t);var n="val="+t+"&id="+o,s=new XMLHttpRequest;s.open("POST","includes/ajax.php",!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onload=function(){},s.send(n),function(){var e=new XMLHttpRequest;e.open("POST","includes/ajax.php",!0),e.onload=function(){if(200==this.status){var e=JSON.parse(this.responseText),t="";for(y in e)t+="<ul><li>"+e[y].login+"</li><li>"+e[y].score+"</li></ul>";console.log(t),document.querySelector(".common_record").innerHTML=t}},e.send()}()}),document.body.addEventListener("selectstart",e=>{e.preventDefault()}),s.addEventListener("click",e=>{v(e.target.className)}),document.body.addEventListener("keydown",e=>{let t;37!=e.keyCode&&65!=e.keyCode||(t="left"),38!=e.keyCode&&87!=e.keyCode||(t="top"),39!=e.keyCode&&68!=e.keyCode||(t="right"),40!=e.keyCode&&83!=e.keyCode||(t="bottom"),v(t)}),o.addEventListener("click",()=>{o.style.top=-o.offsetHeight-9+"px",o.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)",p=3,m=3,H=-1,f=t.offsetWidth/2,c=t.offsetHeight/2,a=!1,d=!1,i=!1,l=!0,record.innerHTML=0,screen_speed.innerHTML="Speed: 30 t.k.p.s.",score_speed.innerHTML="Max speed: 30";var n=setInterval(()=>{!function(o,n){this.x=o,this.y=n,this.start=Date.now(),t.innerHTML+='<div class="moon'+h+'">0 <p class="pm">🌑</p></div>';let s=document.querySelector(".moon"+h);h++,s.style.top=this.x+"px",s.style.left=this.y+"px",function t(){let o=Date.now()-b;if(o>g){e=document.querySelectorAll("#cont div");for(let t=0;t<e.length;t++){let n=parseInt(e[t].innerHTML)+1;g=o+140,n>=T.length&&(n=0),e[t].innerHTML=n+" "+T[n]}}requestAnimationFrame(()=>{t()})}()}(Math.floor(Math.random()*t.offsetHeight),Math.floor(Math.random()*t.offsetWidth)),p<3&&(clearInterval(n),t.innerHTML="")},1847)}),n.addEventListener("click",()=>{n.style.top=t.offsetHeight+9+"px",n.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)",o.innerHTML="🌚PLAY AGAIN!🌝",setTimeout(()=>{o.style.top=t.offsetHeight/80*25+"px",n.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)"},300)}),function o(){switch(!0){case a:f-=p,r.style.transform="rotate(-90deg)";break;case d:f+=p,r.style.transform="rotate(90deg)";break;case i:c-=p,r.style.transform="rotate(0deg)";break;case l:c+=p,r.style.transform="rotate(180deg)"}r.style.top=c+"px",r.style.left=f+"px",requestAnimationFrame(()=>{!function(){e=document.querySelectorAll("#cont div"),left&&f+r.offsetWidth<0?f=t.offsetWidth:right&&f-r.offsetWidth>t.offsetWidth&&(f=-r.offsetWidth),top&&c+r.offsetHeight<0?c=t.offsetHeight:bottom&&c-r.offsetHeight>t.offsetHeight&&(c=-r.offsetHeight);for(let t=0;t<e.length;t++)if(r.offsetTop+M>e[t].offsetTop&&r.offsetTop<e[t].offsetTop+e[t].offsetHeight&&r.offsetLeft+L>e[t].offsetLeft&&r.offsetLeft<e[t].offsetLeft+e[t].offsetWidth)return p+=e[t].children[0].getAttribute("date")/3,m=Math.max(m,p),u=Math.max(u,p),H++,record.innerHTML=H,screen_speed.innerHTML="Speed: "+parseInt(10*p)+" t.k.p.s.",score_speed.innerHTML="Max speed: "+parseInt(10*m),best_speed.innerHTML="Best speed today: "+parseInt(10*u),score_moon.innerHTML="Score: "+(H+1),document.getElementById("gest_record")&&(document.getElementById("gest_record").innerHTML="Лучший результат сегодння: "+parseInt(10*u)),p<3&&(p=0,n.style.top="0px",n.style.transition="top 1s cubic-bezier(.45,-0.67,.53,1.63)"),e[t].style.display="none",record.innerHTML++,k(),u}(),o()})}()});